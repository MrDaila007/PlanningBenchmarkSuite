# Ревью технического задания: Web-визуализация

**Документ:** docs/web_visualization_tz.md  
**Дата ревью:** 2025-02-21  
**Ревьюер:** tz-reviewer  

---

# 1. Общая оценка

| Критерий | Оценка | Комментарий |
|----------|--------|-------------|
| Полнота | ✅ Хорошо | Покрыты все запрошенные аспекты (env, path, metrics, convergence) |
| Согласованность | ✅ Хорошо | Согласован с ТЗ проекта, architecture.md, форматами benchmark |
| Техническая корректность | ✅ Хорошо | Форматы JSON/CSV соответствуют коду |
| Исполнимость | ✅ Хорошо | Чёткие критерии приёмки, понятная структура |

**Вердикт:** Документ утверждён. Замечания R-01, R-02, R-03, N-01, N-03 внесены в ТЗ (2025-02-21).

---

# 2. Детальные замечания

## 2.1 Критичные (исправить)

*Нет критичных замечаний.*

## 2.2 Важные (рекомендуется исправить)

### R-01: Python `to_json` для GridEnvironment

**Где:** Раздел 6.2  
**Суть:** В ТЗ указано «нужно добавить to_json в Python bindings», но в C++ `GridEnvironment::to_json()` уже существует. Нужно уточнить: требуется только экспорт в pybind11 (добавить `.def("to_json", &GridEnvironment::to_json)`), без реализации в C++.

**Рекомендация:** Переформулировать: «Экспортировать `to_json()` в Python bindings (метод уже реализован в C++)».

### R-02: Воссоздание карты из конфига

**Где:** UC-WV-01  
**Суть:** Текущий benchmark не сохраняет карту в results. «Воссоздание карты из конфига» требует вызова MapGenerator с теми же параметрами — это возможно только через Python/C++ код, не через чистый веб-фронт.

**Рекомендация:** Явно указать: воссоздание карты возможно только при наличии Python backend (Phase 2) или предэкспортированного JSON. Для MVP — только загрузка готового JSON с occupancy.

### R-03: Координаты start/goal в конфиге

**Где:** Раздел 6.1, UC-WV-01  
**Суть:** В benchmark_engine.cpp: `State start(exp["start"][1], exp["start"][0])` — порядок [col, row] в JSON как [x, y]. В конфиге `"start": [0, 0]` интерпретируется как col=0, row=0. Стоит явно документировать convention: `[x, y]` или `[col, row]` в JSON.

**Рекомендация:** Добавить в раздел «Форматы» примечание: «В конфиге start/goal: [x, y] = [col, row] для grid (индексы с 0)».

## 2.3 Некритичные (по желанию)

### N-01: Continuous environment

**Где:** Раздел 9 (открытые вопросы)  
**Суть:** Вопрос про continuous/SE2 оставлен открытым — ок. Можно добавить короткую пометку: «Grid — приоритет MVP; continuous — Phase 2».

### N-02: Структура `web/`

**Где:** Раздел 7  
**Суть:** Альтернатива — разместить в `docs/web-viz/` чтобы не засорять корень. Рекомендация: оставить `web/` как в ТЗ, но отметить в README.

### N-03: CDN vs локальные библиотеки

**Где:** Раздел 4.2, Вариант A  
**Суть:** Для offline-режима (NF-04) лучше использовать локальные копии Chart.js/Plotly, не CDN. Стоит явно указать.

**Рекомендация:** Добавить: «Библиотеки — локальные копии в `web/lib/` для работы offline».

---

# 3. Проверка покрытия

| Требование из постановки | Покрыто в ТЗ |
|--------------------------|--------------|
| Визуализация environments (grid maps, obstacles, paths) | ✅ UC-WV-01, UC-WV-02, F-01–F-04 |
| Визуализация planning results (path, convergence, metrics) | ✅ UC-WV-03, UC-WV-04, F-05–F-06 |
| Интеграция с benchmark (JSON, CSV) | ✅ UC-WV-04, UC-WV-05, F-07–F-08 |
| User cases, requirements, architecture sketch | ✅ Разделы 2, 3, 4 |
| Technology choices | ✅ Раздел 4.2 (A/B/C) |
| Data flow benchmark → web UI | ✅ Раздел 4.3 |

---

# 4. Итог

**Рекомендация:** Утвердить ТЗ после внесения правок по R-01, R-02, R-03. Правки R-01 и R-02/R-03 — быстрые уточнения, не меняют общую архитектуру.

**has_critical_issues:** false
